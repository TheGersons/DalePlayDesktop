<Window x:Class="StreamManager.Views.Dialogs.SuscripcionRapidaDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" xmlns:System="clr-namespace:System;assembly=netstandard"
        Title="Suscripción Rápida"
        Width="700"
        Height="750"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="{DynamicResource MaterialDesignPaper}">

    <Grid>
        <!-- Contenido principal -->
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="32">
                <!-- Título -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                    <materialDesign:PackIcon Kind="RocketLaunch"
                                            Width="32"
                                            Height="32"
                                            Foreground="{DynamicResource PrimaryBrush}"
                                            VerticalAlignment="Center"/>
                    <TextBlock Text="Crear Suscripción Rápida"
                              FontSize="24"
                              FontWeight="Bold"
                              Margin="12,0,0,0"
                              VerticalAlignment="Center"/>
                </StackPanel>

                <TextBlock Text="Complete los siguientes pasos para crear una nueva suscripción"
                          FontSize="13"
                          Opacity="0.7"
                          Margin="0,0,0,32"/>

                <!-- PASO 1: CLIENTE -->
                <materialDesign:Card Padding="20" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="32" Height="32" CornerRadius="16"
                                   Background="{DynamicResource PrimaryBrush}"
                                   Margin="0,0,12,0">
                                <TextBlock Text="1" FontSize="16" FontWeight="Bold"
                                          Foreground="White"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Seleccionar Cliente"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <ComboBox x:Name="ClienteComboBox"
                                 materialDesign:HintAssist.Hint="Cliente existente"
                                 Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                 Margin="0,0,0,12"
                                 SelectionChanged="ClienteComboBox_SelectionChanged"/>

                        <Button x:Name="NuevoClienteButton"
                               Content="+ CREAR NUEVO CLIENTE"
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Click="NuevoClienteButton_Click"
                               HorizontalAlignment="Left"/>

                        <!-- Panel para nuevo cliente -->
                        <StackPanel x:Name="NuevoClientePanel"
                                   Visibility="Collapsed"
                                   Margin="0,16,0,0">
                            <TextBox x:Name="NuevoClienteNombreTextBox"
                                    materialDesign:HintAssist.Hint="Nombre completo *"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                    Margin="0,0,0,12"/>

                            <TextBox x:Name="NuevoClienteTelefonoTextBox"
                                    materialDesign:HintAssist.Hint="Teléfono"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- PASO 2: PLATAFORMA -->
                <materialDesign:Card Padding="20" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="32" Height="32" CornerRadius="16"
                                   Background="{DynamicResource PrimaryBrush}"
                                   Margin="0,0,12,0">
                                <TextBlock Text="2" FontSize="16" FontWeight="Bold"
                                          Foreground="White"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Seleccionar Plataforma"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <ComboBox x:Name="PlataformaComboBox"
                                 materialDesign:HintAssist.Hint="Plataforma (Netflix, Disney+, etc.)"
                                 Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                 IsEnabled="False"
                                 SelectionChanged="PlataformaComboBox_SelectionChanged"/>
                    </StackPanel>
                </materialDesign:Card>

                <!-- PASO 3: CUENTA -->
                <materialDesign:Card Padding="20" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="32" Height="32" CornerRadius="16"
                                   Background="{DynamicResource PrimaryBrush}"
                                   Margin="0,0,12,0">
                                <TextBlock Text="3" FontSize="16" FontWeight="Bold"
                                          Foreground="White"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Seleccionar Cuenta de Correo"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <ComboBox x:Name="CuentaComboBox"
                                 materialDesign:HintAssist.Hint="Cuenta existente"
                                 Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                 IsEnabled="False"
                                 Margin="0,0,0,12"
                                 SelectionChanged="CuentaComboBox_SelectionChanged"/>

                        <Button x:Name="NuevaCuentaButton"
                               Content="+ CREAR NUEVA CUENTA"
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Click="NuevaCuentaButton_Click"
                               HorizontalAlignment="Left"/>

                        <!-- Panel para nueva cuenta -->
                        <StackPanel x:Name="NuevaCuentaPanel"
                                   Visibility="Collapsed"
                                   Margin="0,16,0,0">
                            <TextBox x:Name="NuevaCuentaEmailTextBox"
                                    materialDesign:HintAssist.Hint="Email *"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                    Margin="0,0,0,12"/>

                            <PasswordBox x:Name="NuevaCuentaPasswordTextBox"
                                        materialDesign:HintAssist.Hint="Contraseña"
                                        Style="{StaticResource MaterialDesignOutlinedPasswordBox}"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- PASO 4: PERFIL -->
                <materialDesign:Card Padding="20" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="32" Height="32" CornerRadius="16"
                                   Background="{DynamicResource PrimaryBrush}"
                                   Margin="0,0,12,0">
                                <TextBlock Text="4" FontSize="16" FontWeight="Bold"
                                          Foreground="White"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Seleccionar Perfil"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <ComboBox x:Name="PerfilComboBox"
                                 materialDesign:HintAssist.Hint="Perfil disponible"
                                 Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                 IsEnabled="False"
                                 Margin="0,0,0,12"
                                 SelectionChanged="PerfilComboBox_SelectionChanged"/>

                        <!-- Mensaje cuando no hay perfiles disponibles -->
                        <Border x:Name="PerfilesAgotadosPanel"
                               Background="#FFF3E0"
                               CornerRadius="4"
                               Padding="12"
                               Margin="0,0,0,12"
                               Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock Text="⚠️ No hay perfiles disponibles en esta cuenta"
                                          FontSize="13"
                                          FontWeight="SemiBold"
                                          Foreground="#F57C00"
                                          Margin="0,0,0,8"/>
                                <Button x:Name="CrearPerfilEnCuentaNuevaButton"
                                       Content="Crear nuevo perfil"
                                       Style="{StaticResource MaterialDesignFlatButton}"
                                       Foreground="#F57C00"
                                       Click="CrearPerfilEnCuentaNuevaButton_Click"
                                       HorizontalAlignment="Left"
                                       Padding="8,4"/>
                            </StackPanel>
                        </Border>

                        <Button x:Name="NuevoPerfilButton"
                               Content="+ CREAR NUEVO PERFIL"
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Click="NuevoPerfilButton_Click"
                               HorizontalAlignment="Left"/>

                        <!-- Panel para nuevo perfil -->
                        <StackPanel x:Name="NuevoPerfilPanel"
                                   Visibility="Collapsed"
                                   Margin="0,16,0,0">
                            <TextBox x:Name="NuevoPerfilNombreTextBox"
                                    materialDesign:HintAssist.Hint="Nombre del perfil *"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                    Margin="0,0,0,12"/>

                            <TextBox x:Name="NuevoPerfilPinTextBox"
                                    materialDesign:HintAssist.Hint="PIN (opcional)"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                    MaxLength="4"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- PASO 5: DETALLES SUSCRIPCIÓN -->
                <materialDesign:Card Padding="20" Margin="0,0,0,24">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Border Width="32" Height="32" CornerRadius="16"
                                   Background="{DynamicResource PrimaryBrush}"
                                   Margin="0,0,12,0">
                                <TextBlock Text="5" FontSize="16" FontWeight="Bold"
                                          Foreground="White"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="Detalles de Suscripción"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBox x:Name="PrecioTextBox"
                                materialDesign:HintAssist.Hint="Precio mensual (L) *"
                                Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                IsEnabled="False"
                                Margin="0,0,0,12"/>

                        <DatePicker x:Name="FechaInicioDatePicker"
                                   materialDesign:HintAssist.Hint="Fecha de inicio"
                                   Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                   SelectedDate="{x:Static System:DateTime.Today}"/>

                        <TextBlock Text="El próximo pago se calculará automáticamente (+1 mes)"
                                  FontSize="11"
                                  Opacity="0.6"
                                  Margin="0,8,0,0"/>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Botones -->
                <StackPanel Orientation="Horizontal"
                           HorizontalAlignment="Right">
                    <Button x:Name="CancelarButton"
                           Content="CANCELAR"
                           Style="{StaticResource MaterialDesignFlatButton}"
                           Click="CancelarButton_Click"
                           Width="120"
                           Margin="0,0,12,0"/>

                    <Button x:Name="GuardarButton"
                           Content="CREAR SUSCRIPCIÓN"
                           Style="{StaticResource MaterialDesignRaisedButton}"
                           Click="GuardarButton_Click"
                           Width="180"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- Loading overlay -->
        <Grid x:Name="LoadingOverlay"
              Background="#80000000"
              Visibility="Collapsed">
            <StackPanel VerticalAlignment="Center" 
                       HorizontalAlignment="Center">
                <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}"
                            Value="0"
                            IsIndeterminate="True"
                            Width="48"
                            Height="48"/>
                <TextBlock Text="Procesando..." 
                          Foreground="White"
                          Margin="0,16,0,0"
                          HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
